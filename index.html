<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Remi Daigle" />


<title>Using the BESTMPA package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Using the BESTMPA package</h1>
<h4 class="author"><em>Remi Daigle</em></h4>



<p>Basic description of BESTMPAâ€¦</p>
<div id="housekeeping" class="section level2">
<h2>Housekeeping</h2>
<p>Before getting started, using the housekeeping function will prepare the environment and your file structure for modelling. This function will conveniently create a results folder, clear the environment, figures, delete previous results, and increase the memory limit if desired.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(BESTMPA)</code></pre></div>
<pre><code>## Loading required package: BESTMPA</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(rgdal)</code></pre></div>
<pre><code>## Loading required package: rgdal</code></pre>
<pre><code>## Loading required package: sp</code></pre>
<pre><code>## rgdal: version: 1.1-10, (SVN revision 622)
##  Geospatial Data Abstraction Library extensions to R successfully loaded
##  Loaded GDAL runtime: GDAL 2.0.1, released 2015/09/15
##  Path to GDAL shared files: C:/Program Files/R/R-3.3.1/library/rgdal/gdal
##  Loaded PROJ.4 runtime: Rel. 4.9.2, 08 September 2015, [PJ_VERSION: 492]
##  Path to PROJ.4 shared files: C:/Program Files/R/R-3.3.1/library/rgdal/proj
##  Linking to sp version: 1.2-3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(rgeos)</code></pre></div>
<pre><code>## Loading required package: rgeos</code></pre>
<pre><code>## rgeos version: 0.3-20, (SVN revision 535)
##  GEOS runtime version: 3.5.0-CAPI-1.9.0 r4084 
##  Linking to sp version: 1.2-3 
##  Polygon checking: TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(raster)</code></pre></div>
<pre><code>## Loading required package: raster</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(igraph)</code></pre></div>
<pre><code>## Loading required package: igraph</code></pre>
<pre><code>## 
## Attaching package: 'igraph'</code></pre>
<pre><code>## The following object is masked from 'package:raster':
## 
##     union</code></pre>
<pre><code>## The following object is masked from 'package:rgeos':
## 
##     union</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     decompose, spectrum</code></pre>
<pre><code>## The following object is masked from 'package:base':
## 
##     union</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(ggplot2)</code></pre></div>
<pre><code>## Loading required package: ggplot2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(tidyverse)</code></pre></div>
<pre><code>## Loading required package: tidyverse</code></pre>
<pre><code>## Loading tidyverse: tibble
## Loading tidyverse: tidyr
## Loading tidyverse: readr
## Loading tidyverse: purrr
## Loading tidyverse: dplyr</code></pre>
<pre><code>## Conflicts with tidy packages ----------------------------------------------</code></pre>
<pre><code>## as_data_frame(): dplyr, tibble, igraph
## compose():       purrr, igraph
## crossing():      tidyr, igraph
## extract():       tidyr, raster
## filter():        dplyr, stats
## groups():        dplyr, igraph
## lag():           dplyr, stats
## select():        dplyr, raster
## simplify():      purrr, igraph</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(data.table)</code></pre></div>
<pre><code>## Loading required package: data.table</code></pre>
<pre><code>## -------------------------------------------------------------------------</code></pre>
<pre><code>## data.table + dplyr code now lives in dtplyr.
## Please library(dtplyr)!</code></pre>
<pre><code>## -------------------------------------------------------------------------</code></pre>
<pre><code>## 
## Attaching package: 'data.table'</code></pre>
<pre><code>## The following objects are masked from 'package:dplyr':
## 
##     between, last</code></pre>
<pre><code>## The following object is masked from 'package:purrr':
## 
##     transpose</code></pre>
<pre><code>## The following object is masked from 'package:raster':
## 
##     shift</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results_folder &lt;-<span class="st"> &quot;D:/BESTMPA_results&quot;</span>
<span class="kw">housekeeping</span>(<span class="dt">results_folder=</span>results_folder,<span class="dt">env=</span><span class="ot">TRUE</span>,<span class="dt">fig=</span><span class="ot">TRUE</span>,<span class="dt">delete=</span><span class="ot">TRUE</span>,<span class="dt">memorylimit=</span><span class="kw">memory.limit</span>())</code></pre></div>
</div>
<div id="spatial-baselayer" class="section level2">
<h2>Spatial Baselayer</h2>
<div id="exclusive-economic-zone" class="section level3">
<h3>Exclusive Economic Zone</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">EEZ &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="dt">dsn=</span><span class="kw">paste0</span>(<span class="kw">getwd</span>(),<span class="st">&quot;/shapefiles&quot;</span>),<span class="dt">layer=</span><span class="st">&quot;eez_iho_union_v2&quot;</span>)</code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;C:/Users/Remi-Work/Documents/GitHub/BESTMPA/shapefiles&quot;, layer: &quot;eez_iho_union_v2&quot;
## with 5 features
## It has 15 fields</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(EEZ, <span class="dt">col=</span><span class="st">'blue'</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Remove Canadian part of the Davis Strait for EEZ since itâ€™s beyond codâ€™s normal habitat</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(EEZ, <span class="dt">col=</span><span class="st">'blue'</span>)
EEZ &lt;-<span class="st"> </span>EEZ[EEZ$marregion!=<span class="st">&quot;Canadian part of the Davis Strait&quot;</span>,]
<span class="kw">plot</span>(EEZ, <span class="dt">col=</span><span class="st">'red'</span>,<span class="dt">add=</span>T)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="load-cod-habitat-and-breeding-sites" class="section level3">
<h3>Load cod habitat and breeding sites</h3>
<p>Shapefile generated by georeferencing figure 2 from Lough 2004</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Habitats &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="dt">dsn=</span><span class="kw">paste0</span>(<span class="kw">getwd</span>(),<span class="st">&quot;/shapefiles&quot;</span>),<span class="dt">layer=</span><span class="st">&quot;cod_habitat&quot;</span>)</code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;C:/Users/Remi-Work/Documents/GitHub/BESTMPA/shapefiles&quot;, layer: &quot;cod_habitat&quot;
## with 2 features
## It has 31 fields</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(Habitats,<span class="dt">col=</span><span class="st">'green'</span>)
Breeding &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="dt">dsn=</span><span class="kw">paste0</span>(<span class="kw">getwd</span>(),<span class="st">&quot;/shapefiles&quot;</span>),<span class="dt">layer=</span><span class="st">&quot;cod_breeding&quot;</span>)[<span class="dv">2</span>:<span class="dv">15</span>,] <span class="co"># remove first Breeding zone, outside EEZ</span></code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;C:/Users/Remi-Work/Documents/GitHub/BESTMPA/shapefiles&quot;, layer: &quot;cod_breeding&quot;
## with 15 features
## It has 31 fields</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(Breeding,<span class="dt">col=</span><span class="st">'yellow'</span>,<span class="dt">add=</span>T)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="establish-basic-grid" class="section level3">
<h3>Establish basic grid</h3>
<p>Define <code>cell_size</code> in m, minimum size of MPAâ€™s in number of <code>cells</code>, default projection and which areas to include in the gridâ€™s dataframe</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># cell size in m</span>
cell_size &lt;-<span class="st"> </span><span class="dv">20000</span>

<span class="co"># minimum size of MPA</span>
cells=<span class="dv">3</span>

<span class="co"># default projection</span>
proj  &lt;-<span class="st"> &quot;+proj=utm +zone=20 +datum=NAD83 +units=m +no_defs +ellps=GRS80 +towgs84=0,0,0&quot;</span>

<span class="co"># create grid</span>
p &lt;-<span class="st"> </span><span class="kw">initgrid</span>(EEZ,cell_size,proj,<span class="dt">areas=</span><span class="kw">c</span>(<span class="dt">Habitats=</span>Habitats,<span class="dt">Breeding=</span>Breeding))

<span class="kw">plot</span>(p)
<span class="kw">plot</span>(p[p$Habitats==<span class="dv">1</span>,],<span class="dt">col=</span><span class="st">'green'</span>,<span class="dt">add=</span>T)
<span class="kw">plot</span>(p[p$Breeding==<span class="dv">1</span>,],<span class="dt">col=</span><span class="st">'yellow'</span>,<span class="dt">add=</span>T)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="create-protection-scenarios" class="section level3">
<h3>Create protection scenarios</h3>
<p>Define basic parameters for protection scenarios:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load existing MPAS</span>
oldMPA &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="dt">dsn=</span><span class="kw">paste0</span>(<span class="kw">getwd</span>(),<span class="st">&quot;/shapefiles&quot;</span>),<span class="dt">layer=</span><span class="st">&quot;MPAs_mar&quot;</span>)</code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;C:/Users/Remi-Work/Documents/GitHub/BESTMPA/shapefiles&quot;, layer: &quot;MPAs_mar&quot;
## with 401 features
## It has 31 fields</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">oldMPA &lt;-<span class="st"> </span><span class="kw">spTransform</span>(oldMPA,<span class="kw">CRS</span>(proj))

<span class="co">#remove those smaller than cell size</span>
oldMPA &lt;-<span class="st"> </span>oldMPA[<span class="kw">gArea</span>(oldMPA,<span class="dt">byid =</span> <span class="ot">TRUE</span>)&gt;=cell_size^<span class="dv">2</span>,]

oldMPA &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="kw">gCovers</span>(oldMPA,p,<span class="dt">byid =</span> <span class="ot">TRUE</span>),<span class="dv">1</span>,any)|<span class="kw">apply</span>(<span class="kw">gOverlaps</span>(oldMPA,p,<span class="dt">byid =</span> <span class="ot">TRUE</span>),<span class="dv">1</span>,any)

<span class="co"># number of replicates</span>
replicates &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">10</span>

<span class="co"># target protection level in proportion (e.g. 0.2 is 20% protection)</span>
MPA_coverage &lt;-<span class="st"> </span><span class="fl">0.10</span>

<span class="co"># fixed distance for setting MPA distance in km in fixed distance scenario</span>
fixdist &lt;-<span class="st"> </span><span class="dv">75000</span></code></pre></div>
<p>This is how the four scenarios were created. This portion of code is a little time consuming; therefore, I write the grid to file.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ```{r create new scenarios, eval=FALSE, include=FALSE}</span>
#### set status-quo scenario ####
p &lt;-<span class="st"> </span><span class="kw">addscenario</span>(<span class="dt">domain=</span>p,<span class="dt">included=</span>oldMPA,<span class="dt">replicates=</span>replicates,<span class="dt">name=</span><span class="st">&quot;MPA_SQ&quot;</span>,<span class="dt">cells=</span>cells)</code></pre></div>
<pre><code>## Called from: addscenario(domain = p, included = oldMPA, replicates = replicates, 
##     name = &quot;MPA_SQ&quot;, cells = cells)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#21: if (name == &quot;MPA_SQ&quot;) {
##     for (i in replicates) {
##         domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
##     }
##     return(domain)
## } else {
##     require(igraph)
##     require(spdep)
##     nb &lt;- poly2nb(domain, snap = 100)
##     gr &lt;- spdf2graph(domain, nb)
##     for (i in replicates) {
##         print(paste(&quot;calculating replicate&quot;, i))
##         domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
##         MPA_sizes &lt;- generatempasizes(cell_size, cells, domain, 
##             MPA_coverage, included)
##         if (is.na(dist)) {
##             dist &lt;- round(sqrt(length(domain))/(sqrt(length(MPA_sizes)) - 
##                 1))
##         }
##         else {
##             dist &lt;- round(dist/cell_size) + 1
##         }
##         for (j in MPA_sizes) {
##             candidates &lt;- NULL
##             tol &lt;- 1
##             while (length(candidates) &lt; 1) {
##                 candidates &lt;- unique(unlist(neighborhood(gr, 
##                   order = dist, node = which(domain@data[, names(domain) == 
##                     paste0(name, &quot;_&quot;, i)]))))
##                 if (!any(is.na(priority))) 
##                   candidates &lt;- candidates[priority[candidates]]
##                 if (!any(is.na(excluded))) 
##                   candidates &lt;- candidates[!excluded[candidates]]
##                 candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##                   order = dist * tol, node = which(domain@data[, 
##                     names(domain) == paste0(name, &quot;_&quot;, i)])))]
##                 tol &lt;- tol * 0.9
##             }
##             seed &lt;- sample(candidates, 1)
##             while (length(seed) &lt; j) {
##                 seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##                 if (!any(is.na(priority))) 
##                   seed &lt;- seed[priority[seed]]
##                 if (!any(is.na(excluded))) 
##                   seed &lt;- seed[!excluded[seed]]
##             }
##             if (length(seed) &gt; j) 
##                 seed &lt;- seed[1:j]
##             domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
##         }
##     }
##     return(domain)
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#23: for (i in replicates) {
##     domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#24: domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#24: domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#24: domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#24: domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#24: domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#24: domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#24: domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#24: domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#24: domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#24: domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#27: return(domain)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># #### set maximum distance ####</span>
<span class="co"># p &lt;- addscenario(domain=p,included=oldMPA,MPA_coverage=MPA_coverage,replicates=replicates,name=&quot;MPA_MD&quot;,cell_size=cell_size,cells=cells)</span>
<span class="co"># </span>
<span class="co"># #### set fixed distance ####</span>
<span class="co"># p &lt;- addscenario(domain=p,included=oldMPA,MPA_coverage=MPA_coverage,replicates=replicates,dist=fixdist,name=&quot;MPA_FX&quot;,cell_size=cell_size,cells=cells)</span>

#### set targeted scenario ####
p &lt;-<span class="st"> </span><span class="kw">addscenario</span>(<span class="dt">domain=</span>p,<span class="dt">included=</span>oldMPA,<span class="dt">priority=</span>p$Habitats,<span class="dt">excluded=</span>p$Breeding,<span class="dt">MPA_coverage=</span>MPA_coverage,<span class="dt">replicates=</span>replicates,<span class="dt">dist=</span>fixdist,<span class="dt">name=</span><span class="st">&quot;MPA_TR&quot;</span>,<span class="dt">cell_size=</span>cell_size,<span class="dt">cells=</span>cells)</code></pre></div>
<pre><code>## Called from: addscenario(domain = p, included = oldMPA, priority = p$Habitats, 
##     excluded = p$Breeding, MPA_coverage = MPA_coverage, replicates = replicates, 
##     dist = fixdist, name = &quot;MPA_TR&quot;, cell_size = cell_size, cells = cells)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#21: if (name == &quot;MPA_SQ&quot;) {
##     for (i in replicates) {
##         domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
##     }
##     return(domain)
## } else {
##     require(igraph)
##     require(spdep)
##     nb &lt;- poly2nb(domain, snap = 100)
##     gr &lt;- spdf2graph(domain, nb)
##     for (i in replicates) {
##         print(paste(&quot;calculating replicate&quot;, i))
##         domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
##         MPA_sizes &lt;- generatempasizes(cell_size, cells, domain, 
##             MPA_coverage, included)
##         if (is.na(dist)) {
##             dist &lt;- round(sqrt(length(domain))/(sqrt(length(MPA_sizes)) - 
##                 1))
##         }
##         else {
##             dist &lt;- round(dist/cell_size) + 1
##         }
##         for (j in MPA_sizes) {
##             candidates &lt;- NULL
##             tol &lt;- 1
##             while (length(candidates) &lt; 1) {
##                 candidates &lt;- unique(unlist(neighborhood(gr, 
##                   order = dist, node = which(domain@data[, names(domain) == 
##                     paste0(name, &quot;_&quot;, i)]))))
##                 if (!any(is.na(priority))) 
##                   candidates &lt;- candidates[priority[candidates]]
##                 if (!any(is.na(excluded))) 
##                   candidates &lt;- candidates[!excluded[candidates]]
##                 candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##                   order = dist * tol, node = which(domain@data[, 
##                     names(domain) == paste0(name, &quot;_&quot;, i)])))]
##                 tol &lt;- tol * 0.9
##             }
##             seed &lt;- sample(candidates, 1)
##             while (length(seed) &lt; j) {
##                 seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##                 if (!any(is.na(priority))) 
##                   seed &lt;- seed[priority[seed]]
##                 if (!any(is.na(excluded))) 
##                   seed &lt;- seed[!excluded[seed]]
##             }
##             if (length(seed) &gt; j) 
##                 seed &lt;- seed[1:j]
##             domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
##         }
##     }
##     return(domain)
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#32: require(igraph)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#33: require(spdep)</code></pre>
<pre><code>## Loading required package: spdep</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: 'Matrix'</code></pre>
<pre><code>## The following object is masked from 'package:tidyr':
## 
##     expand</code></pre>
<pre><code>## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#35: nb &lt;- poly2nb(domain, snap = 100)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#36: gr &lt;- spdf2graph(domain, nb)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#44: for (i in replicates) {
##     print(paste(&quot;calculating replicate&quot;, i))
##     domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
##     MPA_sizes &lt;- generatempasizes(cell_size, cells, domain, MPA_coverage, 
##         included)
##     if (is.na(dist)) {
##         dist &lt;- round(sqrt(length(domain))/(sqrt(length(MPA_sizes)) - 
##             1))
##     }
##     else {
##         dist &lt;- round(dist/cell_size) + 1
##     }
##     for (j in MPA_sizes) {
##         candidates &lt;- NULL
##         tol &lt;- 1
##         while (length(candidates) &lt; 1) {
##             candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##                 node = which(domain@data[, names(domain) == paste0(name, 
##                   &quot;_&quot;, i)]))))
##             if (!any(is.na(priority))) 
##                 candidates &lt;- candidates[priority[candidates]]
##             if (!any(is.na(excluded))) 
##                 candidates &lt;- candidates[!excluded[candidates]]
##             candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##                 order = dist * tol, node = which(domain@data[, 
##                   names(domain) == paste0(name, &quot;_&quot;, i)])))]
##             tol &lt;- tol * 0.9
##         }
##         seed &lt;- sample(candidates, 1)
##         while (length(seed) &lt; j) {
##             seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##             if (!any(is.na(priority))) 
##                 seed &lt;- seed[priority[seed]]
##             if (!any(is.na(excluded))) 
##                 seed &lt;- seed[!excluded[seed]]
##         }
##         if (length(seed) &gt; j) 
##             seed &lt;- seed[1:j]
##         domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
##     }
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#45: print(paste(&quot;calculating replicate&quot;, i))
## [1] &quot;calculating replicate 1&quot;
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#48: domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#51: MPA_sizes &lt;- generatempasizes(cell_size, cells, domain, MPA_coverage, 
##     included)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#54: if (is.na(dist)) {
##     dist &lt;- round(sqrt(length(domain))/(sqrt(length(MPA_sizes)) - 
##         1))
## } else {
##     dist &lt;- round(dist/cell_size) + 1
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#57: dist &lt;- round(dist/cell_size) + 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#61: for (j in MPA_sizes) {
##     candidates &lt;- NULL
##     tol &lt;- 1
##     while (length(candidates) &lt; 1) {
##         candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##             node = which(domain@data[, names(domain) == paste0(name, 
##                 &quot;_&quot;, i)]))))
##         if (!any(is.na(priority))) 
##             candidates &lt;- candidates[priority[candidates]]
##         if (!any(is.na(excluded))) 
##             candidates &lt;- candidates[!excluded[candidates]]
##         candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##             order = dist * tol, node = which(domain@data[, names(domain) == 
##                 paste0(name, &quot;_&quot;, i)])))]
##         tol &lt;- tol * 0.9
##     }
##     seed &lt;- sample(candidates, 1)
##     while (length(seed) &lt; j) {
##         seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##         if (!any(is.na(priority))) 
##             seed &lt;- seed[priority[seed]]
##         if (!any(is.na(excluded))) 
##             seed &lt;- seed[!excluded[seed]]
##     }
##     if (length(seed) &gt; j) 
##         seed &lt;- seed[1:j]
##     domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#45: print(paste(&quot;calculating replicate&quot;, i))
## [1] &quot;calculating replicate 2&quot;
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#48: domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#51: MPA_sizes &lt;- generatempasizes(cell_size, cells, domain, MPA_coverage, 
##     included)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#54: if (is.na(dist)) {
##     dist &lt;- round(sqrt(length(domain))/(sqrt(length(MPA_sizes)) - 
##         1))
## } else {
##     dist &lt;- round(dist/cell_size) + 1
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#57: dist &lt;- round(dist/cell_size) + 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#61: for (j in MPA_sizes) {
##     candidates &lt;- NULL
##     tol &lt;- 1
##     while (length(candidates) &lt; 1) {
##         candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##             node = which(domain@data[, names(domain) == paste0(name, 
##                 &quot;_&quot;, i)]))))
##         if (!any(is.na(priority))) 
##             candidates &lt;- candidates[priority[candidates]]
##         if (!any(is.na(excluded))) 
##             candidates &lt;- candidates[!excluded[candidates]]
##         candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##             order = dist * tol, node = which(domain@data[, names(domain) == 
##                 paste0(name, &quot;_&quot;, i)])))]
##         tol &lt;- tol * 0.9
##     }
##     seed &lt;- sample(candidates, 1)
##     while (length(seed) &lt; j) {
##         seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##         if (!any(is.na(priority))) 
##             seed &lt;- seed[priority[seed]]
##         if (!any(is.na(excluded))) 
##             seed &lt;- seed[!excluded[seed]]
##     }
##     if (length(seed) &gt; j) 
##         seed &lt;- seed[1:j]
##     domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#45: print(paste(&quot;calculating replicate&quot;, i))
## [1] &quot;calculating replicate 3&quot;
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#48: domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#51: MPA_sizes &lt;- generatempasizes(cell_size, cells, domain, MPA_coverage, 
##     included)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#54: if (is.na(dist)) {
##     dist &lt;- round(sqrt(length(domain))/(sqrt(length(MPA_sizes)) - 
##         1))
## } else {
##     dist &lt;- round(dist/cell_size) + 1
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#57: dist &lt;- round(dist/cell_size) + 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#61: for (j in MPA_sizes) {
##     candidates &lt;- NULL
##     tol &lt;- 1
##     while (length(candidates) &lt; 1) {
##         candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##             node = which(domain@data[, names(domain) == paste0(name, 
##                 &quot;_&quot;, i)]))))
##         if (!any(is.na(priority))) 
##             candidates &lt;- candidates[priority[candidates]]
##         if (!any(is.na(excluded))) 
##             candidates &lt;- candidates[!excluded[candidates]]
##         candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##             order = dist * tol, node = which(domain@data[, names(domain) == 
##                 paste0(name, &quot;_&quot;, i)])))]
##         tol &lt;- tol * 0.9
##     }
##     seed &lt;- sample(candidates, 1)
##     while (length(seed) &lt; j) {
##         seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##         if (!any(is.na(priority))) 
##             seed &lt;- seed[priority[seed]]
##         if (!any(is.na(excluded))) 
##             seed &lt;- seed[!excluded[seed]]
##     }
##     if (length(seed) &gt; j) 
##         seed &lt;- seed[1:j]
##     domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#45: print(paste(&quot;calculating replicate&quot;, i))
## [1] &quot;calculating replicate 4&quot;
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#48: domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#51: MPA_sizes &lt;- generatempasizes(cell_size, cells, domain, MPA_coverage, 
##     included)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#54: if (is.na(dist)) {
##     dist &lt;- round(sqrt(length(domain))/(sqrt(length(MPA_sizes)) - 
##         1))
## } else {
##     dist &lt;- round(dist/cell_size) + 1
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#57: dist &lt;- round(dist/cell_size) + 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#61: for (j in MPA_sizes) {
##     candidates &lt;- NULL
##     tol &lt;- 1
##     while (length(candidates) &lt; 1) {
##         candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##             node = which(domain@data[, names(domain) == paste0(name, 
##                 &quot;_&quot;, i)]))))
##         if (!any(is.na(priority))) 
##             candidates &lt;- candidates[priority[candidates]]
##         if (!any(is.na(excluded))) 
##             candidates &lt;- candidates[!excluded[candidates]]
##         candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##             order = dist * tol, node = which(domain@data[, names(domain) == 
##                 paste0(name, &quot;_&quot;, i)])))]
##         tol &lt;- tol * 0.9
##     }
##     seed &lt;- sample(candidates, 1)
##     while (length(seed) &lt; j) {
##         seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##         if (!any(is.na(priority))) 
##             seed &lt;- seed[priority[seed]]
##         if (!any(is.na(excluded))) 
##             seed &lt;- seed[!excluded[seed]]
##     }
##     if (length(seed) &gt; j) 
##         seed &lt;- seed[1:j]
##     domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#45: print(paste(&quot;calculating replicate&quot;, i))
## [1] &quot;calculating replicate 5&quot;
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#48: domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#51: MPA_sizes &lt;- generatempasizes(cell_size, cells, domain, MPA_coverage, 
##     included)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#54: if (is.na(dist)) {
##     dist &lt;- round(sqrt(length(domain))/(sqrt(length(MPA_sizes)) - 
##         1))
## } else {
##     dist &lt;- round(dist/cell_size) + 1
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#57: dist &lt;- round(dist/cell_size) + 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#61: for (j in MPA_sizes) {
##     candidates &lt;- NULL
##     tol &lt;- 1
##     while (length(candidates) &lt; 1) {
##         candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##             node = which(domain@data[, names(domain) == paste0(name, 
##                 &quot;_&quot;, i)]))))
##         if (!any(is.na(priority))) 
##             candidates &lt;- candidates[priority[candidates]]
##         if (!any(is.na(excluded))) 
##             candidates &lt;- candidates[!excluded[candidates]]
##         candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##             order = dist * tol, node = which(domain@data[, names(domain) == 
##                 paste0(name, &quot;_&quot;, i)])))]
##         tol &lt;- tol * 0.9
##     }
##     seed &lt;- sample(candidates, 1)
##     while (length(seed) &lt; j) {
##         seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##         if (!any(is.na(priority))) 
##             seed &lt;- seed[priority[seed]]
##         if (!any(is.na(excluded))) 
##             seed &lt;- seed[!excluded[seed]]
##     }
##     if (length(seed) &gt; j) 
##         seed &lt;- seed[1:j]
##     domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#45: print(paste(&quot;calculating replicate&quot;, i))
## [1] &quot;calculating replicate 6&quot;
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#48: domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#51: MPA_sizes &lt;- generatempasizes(cell_size, cells, domain, MPA_coverage, 
##     included)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#54: if (is.na(dist)) {
##     dist &lt;- round(sqrt(length(domain))/(sqrt(length(MPA_sizes)) - 
##         1))
## } else {
##     dist &lt;- round(dist/cell_size) + 1
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#57: dist &lt;- round(dist/cell_size) + 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#61: for (j in MPA_sizes) {
##     candidates &lt;- NULL
##     tol &lt;- 1
##     while (length(candidates) &lt; 1) {
##         candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##             node = which(domain@data[, names(domain) == paste0(name, 
##                 &quot;_&quot;, i)]))))
##         if (!any(is.na(priority))) 
##             candidates &lt;- candidates[priority[candidates]]
##         if (!any(is.na(excluded))) 
##             candidates &lt;- candidates[!excluded[candidates]]
##         candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##             order = dist * tol, node = which(domain@data[, names(domain) == 
##                 paste0(name, &quot;_&quot;, i)])))]
##         tol &lt;- tol * 0.9
##     }
##     seed &lt;- sample(candidates, 1)
##     while (length(seed) &lt; j) {
##         seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##         if (!any(is.na(priority))) 
##             seed &lt;- seed[priority[seed]]
##         if (!any(is.na(excluded))) 
##             seed &lt;- seed[!excluded[seed]]
##     }
##     if (length(seed) &gt; j) 
##         seed &lt;- seed[1:j]
##     domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#45: print(paste(&quot;calculating replicate&quot;, i))
## [1] &quot;calculating replicate 7&quot;
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#48: domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#51: MPA_sizes &lt;- generatempasizes(cell_size, cells, domain, MPA_coverage, 
##     included)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#54: if (is.na(dist)) {
##     dist &lt;- round(sqrt(length(domain))/(sqrt(length(MPA_sizes)) - 
##         1))
## } else {
##     dist &lt;- round(dist/cell_size) + 1
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#57: dist &lt;- round(dist/cell_size) + 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#61: for (j in MPA_sizes) {
##     candidates &lt;- NULL
##     tol &lt;- 1
##     while (length(candidates) &lt; 1) {
##         candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##             node = which(domain@data[, names(domain) == paste0(name, 
##                 &quot;_&quot;, i)]))))
##         if (!any(is.na(priority))) 
##             candidates &lt;- candidates[priority[candidates]]
##         if (!any(is.na(excluded))) 
##             candidates &lt;- candidates[!excluded[candidates]]
##         candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##             order = dist * tol, node = which(domain@data[, names(domain) == 
##                 paste0(name, &quot;_&quot;, i)])))]
##         tol &lt;- tol * 0.9
##     }
##     seed &lt;- sample(candidates, 1)
##     while (length(seed) &lt; j) {
##         seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##         if (!any(is.na(priority))) 
##             seed &lt;- seed[priority[seed]]
##         if (!any(is.na(excluded))) 
##             seed &lt;- seed[!excluded[seed]]
##     }
##     if (length(seed) &gt; j) 
##         seed &lt;- seed[1:j]
##     domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#45: print(paste(&quot;calculating replicate&quot;, i))
## [1] &quot;calculating replicate 8&quot;
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#48: domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#51: MPA_sizes &lt;- generatempasizes(cell_size, cells, domain, MPA_coverage, 
##     included)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#54: if (is.na(dist)) {
##     dist &lt;- round(sqrt(length(domain))/(sqrt(length(MPA_sizes)) - 
##         1))
## } else {
##     dist &lt;- round(dist/cell_size) + 1
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#57: dist &lt;- round(dist/cell_size) + 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#61: for (j in MPA_sizes) {
##     candidates &lt;- NULL
##     tol &lt;- 1
##     while (length(candidates) &lt; 1) {
##         candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##             node = which(domain@data[, names(domain) == paste0(name, 
##                 &quot;_&quot;, i)]))))
##         if (!any(is.na(priority))) 
##             candidates &lt;- candidates[priority[candidates]]
##         if (!any(is.na(excluded))) 
##             candidates &lt;- candidates[!excluded[candidates]]
##         candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##             order = dist * tol, node = which(domain@data[, names(domain) == 
##                 paste0(name, &quot;_&quot;, i)])))]
##         tol &lt;- tol * 0.9
##     }
##     seed &lt;- sample(candidates, 1)
##     while (length(seed) &lt; j) {
##         seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##         if (!any(is.na(priority))) 
##             seed &lt;- seed[priority[seed]]
##         if (!any(is.na(excluded))) 
##             seed &lt;- seed[!excluded[seed]]
##     }
##     if (length(seed) &gt; j) 
##         seed &lt;- seed[1:j]
##     domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#45: print(paste(&quot;calculating replicate&quot;, i))
## [1] &quot;calculating replicate 9&quot;
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#48: domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#51: MPA_sizes &lt;- generatempasizes(cell_size, cells, domain, MPA_coverage, 
##     included)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#54: if (is.na(dist)) {
##     dist &lt;- round(sqrt(length(domain))/(sqrt(length(MPA_sizes)) - 
##         1))
## } else {
##     dist &lt;- round(dist/cell_size) + 1
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#57: dist &lt;- round(dist/cell_size) + 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#61: for (j in MPA_sizes) {
##     candidates &lt;- NULL
##     tol &lt;- 1
##     while (length(candidates) &lt; 1) {
##         candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##             node = which(domain@data[, names(domain) == paste0(name, 
##                 &quot;_&quot;, i)]))))
##         if (!any(is.na(priority))) 
##             candidates &lt;- candidates[priority[candidates]]
##         if (!any(is.na(excluded))) 
##             candidates &lt;- candidates[!excluded[candidates]]
##         candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##             order = dist * tol, node = which(domain@data[, names(domain) == 
##                 paste0(name, &quot;_&quot;, i)])))]
##         tol &lt;- tol * 0.9
##     }
##     seed &lt;- sample(candidates, 1)
##     while (length(seed) &lt; j) {
##         seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##         if (!any(is.na(priority))) 
##             seed &lt;- seed[priority[seed]]
##         if (!any(is.na(excluded))) 
##             seed &lt;- seed[!excluded[seed]]
##     }
##     if (length(seed) &gt; j) 
##         seed &lt;- seed[1:j]
##     domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#45: print(paste(&quot;calculating replicate&quot;, i))
## [1] &quot;calculating replicate 10&quot;
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#48: domain[[paste0(name, &quot;_&quot;, i)]] &lt;- included
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#51: MPA_sizes &lt;- generatempasizes(cell_size, cells, domain, MPA_coverage, 
##     included)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#54: if (is.na(dist)) {
##     dist &lt;- round(sqrt(length(domain))/(sqrt(length(MPA_sizes)) - 
##         1))
## } else {
##     dist &lt;- round(dist/cell_size) + 1
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#57: dist &lt;- round(dist/cell_size) + 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#61: for (j in MPA_sizes) {
##     candidates &lt;- NULL
##     tol &lt;- 1
##     while (length(candidates) &lt; 1) {
##         candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##             node = which(domain@data[, names(domain) == paste0(name, 
##                 &quot;_&quot;, i)]))))
##         if (!any(is.na(priority))) 
##             candidates &lt;- candidates[priority[candidates]]
##         if (!any(is.na(excluded))) 
##             candidates &lt;- candidates[!excluded[candidates]]
##         candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##             order = dist * tol, node = which(domain@data[, names(domain) == 
##                 paste0(name, &quot;_&quot;, i)])))]
##         tol &lt;- tol * 0.9
##     }
##     seed &lt;- sample(candidates, 1)
##     while (length(seed) &lt; j) {
##         seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##         if (!any(is.na(priority))) 
##             seed &lt;- seed[priority[seed]]
##         if (!any(is.na(excluded))) 
##             seed &lt;- seed[!excluded[seed]]
##     }
##     if (length(seed) &gt; j) 
##         seed &lt;- seed[1:j]
##     domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#62: candidates &lt;- NULL
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#63: tol &lt;- 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: while (length(candidates) &lt; 1) {
##     candidates &lt;- unique(unlist(neighborhood(gr, order = dist, 
##         node = which(domain@data[, names(domain) == paste0(name, 
##             &quot;_&quot;, i)]))))
##     if (!any(is.na(priority))) 
##         candidates &lt;- candidates[priority[candidates]]
##     if (!any(is.na(excluded))) 
##         candidates &lt;- candidates[!excluded[candidates]]
##     candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##         order = dist * tol, node = which(domain@data[, names(domain) == 
##             paste0(name, &quot;_&quot;, i)])))]
##     tol &lt;- tol * 0.9
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#66: candidates &lt;- unique(unlist(neighborhood(gr, order = dist, node = which(domain@data[, 
##     names(domain) == paste0(name, &quot;_&quot;, i)]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: if (!any(is.na(priority))) candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#69: candidates &lt;- candidates[priority[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: if (!any(is.na(excluded))) candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#70: candidates &lt;- candidates[!excluded[candidates]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#72: candidates &lt;- candidates[!candidates %in% unlist(neighborhood(gr, 
##     order = dist * tol, node = which(domain@data[, names(domain) == 
##         paste0(name, &quot;_&quot;, i)])))]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#74: tol &lt;- tol * 0.9
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#64: (while) length(candidates) &lt; 1
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#77: seed &lt;- sample(candidates, 1)
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: while (length(seed) &lt; j) {
##     seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
##     if (!any(is.na(priority))) 
##         seed &lt;- seed[priority[seed]]
##     if (!any(is.na(excluded))) 
##         seed &lt;- seed[!excluded[seed]]
## }
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#79: seed &lt;- unique(c(seed, sample(unlist(nb[seed]))))
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: if (!any(is.na(priority))) seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#81: seed &lt;- seed[priority[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: if (!any(is.na(excluded))) seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#82: seed &lt;- seed[!excluded[seed]]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#78: (while) length(seed) &lt; j
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: if (length(seed) &gt; j) seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#84: seed &lt;- seed[1:j]
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#86: domain[[paste0(name, &quot;_&quot;, i)]][seed] &lt;- TRUE
## debug at C:/Users/Remi-Work/Documents/GitHub/BESTMPA/R/addscenario.R#91: return(domain)</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">writeOGR</span>(p,<span class="dt">dsn=</span><span class="st">&quot;shapefiles&quot;</span>,<span class="dt">layer=</span><span class="st">&quot;master_polygon&quot;</span>,<span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>,<span class="dt">overwrite_layer =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Instead, I load default grid file that was saved to file to save time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="dt">dsn=</span><span class="st">&quot;shapefiles&quot;</span>,<span class="dt">layer=</span><span class="st">&quot;master_polygon&quot;</span>)</code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;shapefiles&quot;, layer: &quot;master_polygon&quot;
## with 4779 features
## It has 23 fields</code></pre>
</div>
</div>
<div id="looping-for-time-and-scenarios" class="section level1">
<h1>Looping for time and scenarios</h1>
<div id="define-variable-to-be-used-in-the-loops." class="section level2">
<h2>Define variable to be used in the loops.</h2>
<div id="define-time" class="section level3">
<h3>Define time</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># total model run time in years (e.g. 2001:2100 would be 100 years)</span>
time &lt;-<span class="st"> </span><span class="dv">2021</span>:<span class="dv">2071</span>
spinup &lt;-<span class="st"> </span><span class="dv">20</span> <span class="co"># number of years before &quot;time&quot; the model starts, results from spin-up years are not saved, all scenarios start as status quo</span>
tot_time &lt;-<span class="st"> </span>(<span class="kw">min</span>(time)-spinup):<span class="kw">max</span>(time)</code></pre></div>
</div>
<div id="define-fish-growth-and-reproduction" class="section level3">
<h3>Define fish growth and reproduction</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Von Bertalanffy growth model parameters (Knickle and Rose 2013)</span>
<span class="co"># Lt = Linf * {1-exp(-k*(t-t0))}, where Lt is length (cm) at age t (year), Linf is the asymptotic length (cm), k is the VB growth coefficient (1/year), and t0 is the x intercept (year). Linf = 112.03 (95% CI = 10.46). k = 0.13 (95% CI = 0.021). t0 = 0.18).</span>
Linf_mean &lt;-<span class="st"> </span><span class="fl">112.03</span>
Linf_SD &lt;-<span class="st"> </span><span class="fl">10.46</span>/<span class="fl">1.96</span>
k_mean &lt;-<span class="st"> </span><span class="fl">0.13</span>
k_SD &lt;-<span class="st"> </span><span class="fl">0.021</span>/<span class="fl">1.96</span>
t0 &lt;-<span class="st"> </span><span class="fl">0.18</span>

<span class="co"># calculate new weight - Length-weight relationship (Knickle and Rose 2013) fish$weight &lt;- l_to_w_int * fish$length^l_to_w_power</span>
l_to_w_int  &lt;-<span class="st"> </span><span class="fl">0.000011</span>
l_to_w_power &lt;-<span class="st"> </span><span class="fl">2.91</span>

<span class="co"># minimum age at maturity logistic equation</span>
age_mat_steepness &lt;-<span class="st"> </span><span class="fl">2.5</span>
age_mat_sigmoid &lt;-<span class="st"> </span><span class="dv">4</span>


<span class="co"># Fecundity (size dependent). 0.5 million eggs per kg of female</span>
fecundity &lt;-<span class="st"> </span><span class="fl">0.5</span>*<span class="dv">10</span>^<span class="dv">6</span>

<span class="co"># Maximum age considered in matrix</span>
maxage &lt;-<span class="st"> </span><span class="dv">20</span>

<span class="co"># calculate which breeding area is closest to each grid cell</span>
breeding_near &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="kw">gDistance</span>(<span class="kw">spTransform</span>(Breeding,proj),p,<span class="dt">byid =</span> T),<span class="dv">1</span>,which.min)

<span class="co"># initial abundance</span>
initial_abun=<span class="dv">250</span>*<span class="dv">10</span>^<span class="dv">6</span></code></pre></div>
</div>
<div id="define-sources-of-natural-mortality" class="section level3">
<h3>Define sources of natural mortality</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># natural mortality (Swain &amp; Chouinard 2008)</span>
M &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10000</span>,<span class="fl">0.5938</span>,<span class="fl">0.0517</span>)
M &lt;-<span class="st"> </span>M[M&lt;=<span class="dv">1</span>&amp;M&gt;=<span class="dv">0</span>] <span class="co"># eliminate any possible values of M &gt;1 or M &lt;0</span>

<span class="co"># larval mortality (Mountain et al. 2008)</span>
lM &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">10000</span>,<span class="dv">1000</span>,<span class="fl">1.2</span>) <span class="co">#larval mortality of 99.88% (range 98.98-99.99%)</span>
<span class="co">#hist(lM);mean(lM);min(lM);max(lM)</span>

<span class="co"># Beverton-Holt model for carrying capacity based recruitment mortality, carrying capacity is the mean of North American carrying capacities in Table 3 of Myers et al. 2001 (mean of log CC=-1.202222222 tonnes/km^2 SD=0.9199018667)</span>

<span class="co"># Habitat carrying capacity, in kg of virtual fish per cell (4779 is the number of cells in the default grid). This could be substituted with &quot;known&quot; habitat carrying capacity.</span>
CCs &lt;-<span class="st"> </span>(<span class="dv">10</span>^<span class="kw">rnorm</span>(<span class="dv">10000</span>,-<span class="fl">1.202222222</span>,<span class="fl">0.9199018667</span>))*(cell_size^<span class="dv">2</span>)/<span class="dv">1000</span>
CCs &lt;-<span class="st"> </span>CCs[CCs&gt;<span class="dv">0</span>][<span class="dv">1</span>:<span class="dv">4779</span>] <span class="co">#enforce no negative CCs</span>
<span class="co"># adjust CCs to be 0 outside habitat</span>
CCs &lt;-<span class="st"> </span>CCs*p$Habitats</code></pre></div>
</div>
<div id="define-dispersal" class="section level3">
<h3>Define dispersal</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># larval dispersal kernels are assumed to be exponential, e_fold_larvae is the e folding scale in km (the distance at which there will be fewer settlers by a factor of e). We assume that scale to be sqrt of 2cm/s*90d (avg current velocity * PLD) because we assume that the current is like a random walk</span>
e_fold_larvae &lt;-<span class="st"> </span><span class="dv">2</span>/<span class="dv">100000</span>*<span class="dv">60</span>*<span class="dv">60</span>*<span class="dv">24</span>*<span class="dv">90</span>*<span class="dv">1000</span>

<span class="co"># adult dispersal kernels are also assumed to be exponential, e_fold_adult (in km) was calculated from data in Lawson &amp; Rose 2000</span>
e_fold_adult  &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="fl">74.139</span>*<span class="dv">1000</span>)
<span class="co"># minimium age for adult migration (minimum size is 50 cm) Lawson &amp; Rose 2000</span>
min_age_migration &lt;-<span class="st"> </span><span class="kw">which.min</span>(<span class="kw">abs</span>(<span class="kw">age2length</span>(<span class="dv">1</span>:maxage)-<span class="dv">50</span>))

<span class="co"># generate connectivity matrix</span>
<span class="co">#adult</span>
cma &lt;-<span class="st"> </span><span class="kw">initcm</span>(p,e_fold_adult,cell_size)
<span class="co">#larvae</span>
cml &lt;-<span class="st"> </span><span class="kw">initcm</span>(p,e_fold_larvae,cell_size)</code></pre></div>
</div>
<div id="define-fisherman-behaviour-and-management" class="section level3">
<h3>Define fisherman behaviour and management</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># specify spatial distribution of fish_licenses for shore distance calculation in effort calculation</span>
<span class="co"># can be spatial points or spatial polygons data frame (sp package)</span>
fish_communities &lt;-<span class="st"> </span><span class="kw">getData</span>(<span class="st">'GADM'</span>, <span class="dt">country=</span><span class="st">&quot;CAN&quot;</span>, <span class="dt">level=</span><span class="dv">1</span>) <span class="co"># provinces</span>
fish_communities &lt;-<span class="st"> </span>fish_communities[fish_communities$NAME_1==<span class="st">&quot;New Brunswick&quot;</span>|
<span class="st">                                         </span>fish_communities$NAME_1==<span class="st">&quot;Newfoundland and Labrador&quot;</span>|
<span class="st">                                         </span>fish_communities$NAME_1==<span class="st">&quot;Nova Scotia&quot;</span>|
<span class="st">                                         </span>fish_communities$NAME_1==<span class="st">&quot;Prince Edward Island&quot;</span>|
<span class="st">                                         </span>fish_communities$ID_1==<span class="dv">11</span>,]    <span class="co"># this means Quebec, the accent make bad things happen when formatting</span>
<span class="co"># fish_communities &lt;- getBigPolys(gSimplify(fish_communities,tol=0.05,topologyPreserve = T))</span>
fish_communities &lt;-<span class="kw">gSimplify</span>(fish_communities,<span class="dt">tol=</span><span class="fl">0.05</span>,<span class="dt">topologyPreserve =</span> T)

<span class="kw">plot</span>(fish_communities)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># number of licenses per region in fish_communities</span>
fish_licenses &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">866</span>, <span class="dv">4714</span>, <span class="dv">3002</span>, <span class="dv">879</span>, <span class="dv">963</span>)

<span class="co"># fisheries mortality at Maximum Sustainable Yield (Mountain et al. 2008)</span>
FMSY &lt;-<span class="st"> </span><span class="fl">0.28</span>

<span class="co"># quota set to fraction of FMSY as per precautionary principle</span>
FMSY_buffer &lt;-<span class="st"> </span><span class="dv">2</span>/<span class="dv">3</span>

<span class="co"># number of years to use in biomass estimate</span>
biomass_est_n_years &lt;-<span class="st"> </span><span class="dv">5</span>

<span class="co"># minimium age caught by nets (minimum size is 38 cm) Feekings et al. 2013</span>
min_age_catch &lt;-<span class="st"> </span><span class="kw">which.min</span>(<span class="kw">abs</span>(<span class="kw">age2length</span>(<span class="dv">1</span>:maxage)-<span class="dv">38</span>))

<span class="co"># calculate distances from shore</span>
distance &lt;-<span class="st"> </span><span class="kw">gDistance</span>(<span class="kw">spTransform</span>(fish_communities,proj),p,<span class="dt">byid =</span> T)

<span class="co"># list scenarios for looping</span>
scenarios &lt;-<span class="st"> </span><span class="kw">names</span>(p)[<span class="kw">grep</span>(<span class="st">&quot;MPA_&quot;</span>,<span class="kw">names</span>(p))] <span class="co"># assumes all scenarios begin with &quot;MPA_&quot;</span>
scenarios &lt;-<span class="st"> </span>scenarios[<span class="kw">order</span>(<span class="kw">as.numeric</span>(<span class="kw">substr</span>(scenarios,<span class="dv">8</span>,<span class="kw">nchar</span>(scenarios))))]</code></pre></div>
</div>
</div>
<div id="loop-over-scenario-and-time" class="section level2">
<h2>Loop over scenario and time</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#```{r Loop over scenario and time, eval=FALSE, include=FALSE}</span>

pb &lt;-<span class="st"> </span><span class="kw">progressBar</span>(<span class="st">&quot;Looping through scenarios and time&quot;</span>, <span class="st">&quot;scenario&quot;</span>,<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)
for(s in scenarios){
    for(y in tot_time){
        <span class="kw">gc</span>() <span class="co"># keeps memory from getting clogged</span>
        <span class="kw">setProgressBar</span>(pb, (<span class="kw">which</span>(s==scenarios)-<span class="dv">1</span>)/<span class="kw">length</span>(scenarios)+(<span class="dv">1</span>/<span class="kw">length</span>(scenarios)*((y-<span class="kw">min</span>(tot_time))/<span class="kw">length</span>(tot_time))), <span class="dt">label=</span><span class="kw">paste</span>(<span class="st">&quot;Calculating scenario:&quot;</span>,s,<span class="st">&quot;year:&quot;</span>,y))
        ############################ Growth and reproduction #################################################
        fish &lt;-<span class="st"> </span><span class="kw">growth</span>(fish,y,tot_time,initial_abun,p,maxage,recruits,M)
        
        #### reproduction ####
        recruits &lt;-<span class="st"> </span><span class="kw">reproduction</span>(fish,fecundity,age_mat_steepness,age_mat_sigmoid,l_to_w_int,l_to_w_power,Linf_mean,Linf_SD,k_mean,k_SD,t0,breeding_near,p)
        
        ############################ Dispersal #################################################
        #### adult dispersal ####
        fish &lt;-<span class="st"> </span><span class="kw">dispersal</span>(fish,<span class="dt">cm=</span>cma,<span class="dt">ages=</span>min_age_migration:maxage)
        
        #### larval dispersal ####
        recruits &lt;-<span class="st"> </span><span class="kw">larvaldispersal</span>(recruits,cml,lM,CCs)
        
        ############################ Harvesting #################################################
        quota &lt;-<span class="st"> </span><span class="kw">estimatequota</span>(fish,maxage,biomass_est_bank,y,tot_time,FMSY,FMSY_buffer)
        
        fish &lt;-<span class="st"> </span><span class="kw">harvest</span>(fish,quota,<span class="dt">ages=</span>min_age_catch:maxage,distance,fish_licenses,<span class="dt">mpaSQ=</span>p$MPA_SQ_1,<span class="dt">mpa2020=</span>p[[s]],<span class="dt">writefish=</span><span class="ot">TRUE</span>,<span class="dt">writefishcatch=</span><span class="ot">TRUE</span>,<span class="dt">writekg=</span><span class="ot">TRUE</span>,results_folder)
        
    }
}

<span class="kw">close</span>(pb)</code></pre></div>
<pre><code>## NULL</code></pre>
<div id="define-cost-evaluation" class="section level3">
<h3>Define cost evaluation</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">########################################### cost evaluation ##############################################
<span class="co"># normal operating cost ($) per fisherman from (Department of Fisheries and Oceans, 2007, Table A.19 Mixed Fishery Fleet)</span>
<span class="co"># labour (CAD $46587) and fuel ($9008) vary with distance, the remainder does not</span>
fish_operating_cost_ratio &lt;-<span class="st"> </span>(<span class="dv">46587+9008</span>)/<span class="dv">105054</span> <span class="co"># (labour+fuel)/total</span>
<span class="co"># default profitability to calibrate operating cost (Department of Fisheries and Oceans, 2007, Table A.19 and 5.7 Mixed Fishery Fleet)</span>
Status_quo_profitability &lt;-<span class="st"> </span><span class="dv">166184</span>/<span class="dv">105054</span> <span class="co">#$ catch value/$ operating expense</span>

<span class="co"># landed value for cod CAD/kg (http://www.dfo-mpo.gc.ca/stats/commercial/sea-maritimes-eng.htm)</span>
fish_landed_value &lt;-<span class="st"> </span><span class="fl">1.24</span>

<span class="co"># Social discount rates (choose 3)</span>
SDR &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.015</span>,<span class="fl">0.03</span>,<span class="fl">0.06</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load fish catches</span>
filenames &lt;-<span class="st"> </span><span class="kw">list.files</span>(results_folder,<span class="dt">pattern=</span><span class="st">&quot;kg_&quot;</span>)
<span class="co"># filenames &lt;- filenames[c(grep('SQ',filenames),grep('TR',filenames))]</span>
fileinfo &lt;-<span class="st"> </span><span class="kw">substr</span>(filenames,<span class="dv">8</span>,<span class="kw">nchar</span>(filenames)-<span class="dv">4</span>)

catch &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="kw">paste0</span>(results_folder,<span class="st">'/'</span>,filenames), fread, <span class="dt">col.names=</span><span class="kw">c</span>(<span class="st">&quot;cell&quot;</span>,<span class="kw">paste</span>(<span class="st">&quot;community_&quot;</span>,<span class="kw">names</span>(fish_communities)))) %&gt;%
<span class="st">    </span><span class="kw">setNames</span>(fileinfo) %&gt;%
<span class="st">    </span><span class="kw">rbindlist</span>(<span class="dt">use.names=</span><span class="ot">TRUE</span>,<span class="dt">idcol=</span><span class="ot">TRUE</span>) %&gt;%
<span class="st">    </span><span class="kw">separate</span>(<span class="dt">col=</span>.id,<span class="dt">into=</span><span class="kw">c</span>(<span class="st">&quot;scenario&quot;</span>,<span class="st">&quot;replicate&quot;</span>,<span class="st">&quot;year&quot;</span>)) %&gt;%
<span class="st">    </span><span class="kw">gather</span>(community,kg,<span class="kw">starts_with</span>(<span class="st">&quot;community_&quot;</span>)) %&gt;%
<span class="st">    </span><span class="kw">ungroup</span>()


catch$grossvalue &lt;-<span class="st"> </span>catch$kg*fish_landed_value

catch$distancekm &lt;-<span class="st"> </span><span class="kw">as.vector</span>(distance)/<span class="dv">1000</span>

catch_summary &lt;-<span class="st"> </span>catch %&gt;%
<span class="st">    </span><span class="kw">group_by</span>(scenario,replicate,year) %&gt;%
<span class="st">    </span><span class="kw">summarise</span>(<span class="dt">distanceGV=</span><span class="kw">weighted.mean</span>(distancekm,grossvalue),
              <span class="dt">grossvalue=</span><span class="kw">sum</span>(grossvalue)) %&gt;%
<span class="st">    </span><span class="kw">ungroup</span>()

catch_summary$distanceGV[<span class="kw">is.nan</span>(catch_summary$distanceGV)] &lt;-<span class="st"> </span><span class="dv">0</span>

SQinitialstats &lt;-<span class="st"> </span>catch_summary %&gt;%
<span class="st">    </span><span class="kw">filter</span>(scenario==<span class="st">&quot;SQ&quot;</span>,year==<span class="kw">min</span>(time)) %&gt;%
<span class="st">    </span><span class="kw">summarize</span>(<span class="dt">distanceGV=</span><span class="kw">mean</span>(distanceGV,<span class="dt">na.rm=</span>T),
              <span class="dt">grossvalue=</span><span class="kw">mean</span>(grossvalue,<span class="dt">na.rm=</span>T))

fleetfixedcost &lt;-<span class="st"> </span>SQinitialstats$grossvalue/Status_quo_profitability*(<span class="dv">1</span>-fish_operating_cost_ratio)
fleetvariablecost &lt;-<span class="st"> </span>SQinitialstats$grossvalue/Status_quo_profitability*fish_operating_cost_ratio/SQinitialstats$distanceGV

catch_summary$netvalue &lt;-<span class="st"> </span>catch_summary$grossvalue-fleetfixedcost-(fleetvariablecost*catch_summary$distanceGV)
catch_summary$cumsum &lt;-<span class="st"> </span><span class="kw">do.call</span>(c, <span class="kw">tapply</span>(catch_summary$netvalue,
                                          <span class="kw">paste0</span>(catch_summary$scenario, catch_summary$replicate),
                                          <span class="dt">FUN=</span>cumsum))



<span class="kw">ggplot</span>(catch_summary,<span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">as.numeric</span>(year),<span class="dt">y=</span>grossvalue,<span class="dt">colour=</span>scenario))+
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">cex=</span><span class="dv">2</span>)+<span class="kw">geom_smooth</span>()+
<span class="st">    </span><span class="kw">theme_classic</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(catch_summary,<span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">as.numeric</span>(year),<span class="dt">y=</span>cumsum,<span class="dt">colour=</span>scenario))+
<span class="st">    </span><span class="co"># geom_point(cex=2)+</span>
<span class="st">    </span><span class="kw">geom_smooth</span>()+
<span class="st">    </span><span class="kw">theme_classic</span>()+
<span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;yellow&quot;</span>,<span class="st">&quot;blue&quot;</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(catch_summary,<span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">as.numeric</span>(year),<span class="dt">y=</span>distanceGV,<span class="dt">colour=</span>scenario))+
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">cex=</span><span class="dv">2</span>)+<span class="kw">geom_smooth</span>()+
<span class="st">    </span><span class="kw">theme_classic</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
